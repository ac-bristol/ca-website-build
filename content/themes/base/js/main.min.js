/*! Andy 2014-08-29 */
!function(a){var b=function(){var b=(a(window).width(),a(window).height());a("#home-intro").css({height:b})},c=function(){a("section.ajax-load-more-wrap").prepend("<h2>header</h2>").removeAttr("id")},d=function(){a("a[href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var b=a(this.hash);if(b=b.length?b:a("[name="+this.hash.slice(1)+"]"),b.length)return a("html,body").animate({scrollTop:b.offset().top},1e3),!1}})};a(window).load(function(){b(),d(),c();var e={};e.Todo=Backbone.Model.extend({defaults:{title:"",completed:!1},toggle:function(){this.save({completed:!this.get("completed")})}}),e.TodoList=Backbone.Collection.extend({model:e.Todo,localStorage:new Store("backbone-todo"),completed:function(){return this.filter(function(a){return a.get("completed")})},remaining:function(){return this.without.apply(this,this.completed())}}),e.todoList=new e.TodoList,e.TodoView=Backbone.View.extend({tagName:"li",template:_.template(a("#item-template").html()),render:function(){return this.$el.html(this.template(this.model.toJSON())),this.input=this.$(".edit"),this},initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.remove,this)},events:{"dblclick label":"edit","keypress .edit":"updateOnEnter","blur .edit":"close","click .toggle":"toggleCompleted","click .destroy":"destroy"},edit:function(){this.$el.addClass("editing"),this.input.focus()},close:function(){var a=this.input.val().trim();a&&this.model.save({title:a}),this.$el.removeClass("editing")},updateOnEnter:function(a){13==a.which&&this.close()},toggleCompleted:function(){this.model.toggle()},destroy:function(){this.model.destroy()}}),e.AppView=Backbone.View.extend({el:"#todoapp",initialize:function(){this.input=this.$("#new-todo"),e.todoList.on("add",this.addAll,this),e.todoList.on("reset",this.addAll,this),e.todoList.fetch()},events:{"keypress #new-todo":"createTodoOnEnter"},createTodoOnEnter:function(a){13===a.which&&this.input.val().trim()&&(e.todoList.create(this.newAttributes()),this.input.val(""))},addOne:function(b){var c=new e.TodoView({model:b});a("#todo-list").append(c.render().el)},addAll:function(){switch(this.$("#todo-list").html(""),window.filter){case"pending":_.each(e.todoList.remaining(),this.addOne);break;case"completed":_.each(e.todoList.completed(),this.addOne);break;default:e.todoList.each(this.addOne,this)}},newAttributes:function(){return{title:this.input.val().trim(),completed:!1}}}),e.Router=Backbone.Router.extend({routes:{"*filter":"setFilter"},setFilter:function(a){console.log("app.router.params = "+a),window.filter=a.trim()||"",e.todoList.trigger("reset")}}),e.router=new e.Router,Backbone.history.start(),e.appView=new e.AppView}),a(window).resize(function(){b()})}(jQuery);